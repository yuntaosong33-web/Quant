# A股量化交易系统 - 策略配置文件
# ===============================
# 激进型高收益小市值策略 (Aggressive Small Cap Strategy)

# 数据配置
data:
  # 股票池: hs300(沪深300), zz500(中证500), all(全市场)
  # 激进策略使用全市场选股，捕捉小市值机会
  stock_pool: "all"
  
  # 历史数据开始日期
  start_date: "2020-01-01"
  
  # 每次增量更新的天数
  update_days: 5
  
  # 数据存储路径
  raw_data_path: "data/raw"
  processed_data_path: "data/processed"

# 策略配置 - 激进型小市值策略
strategy:
  # 策略名称
  name: "Aggressive Small Cap Strategy"
  
  # 因子权重配置 (激进型)
  # Total_Score = value_weight * SmallCap_Z + quality_weight * Turnover_Z 
  #             + momentum_weight * RSI_Z + size_weight * SmallCap_Z
  # 注意：放弃传统价值因子，改用小市值+高换手+动量的激进组合
  value_weight: 0.0      # 放弃估值因子（借用此位置放小市值因子）
  quality_weight: 0.3    # 借用此位置放换手率因子（资金活跃度）
  momentum_weight: 0.4   # 动量因子权重 (RSI)
  size_weight: 0.3       # 新增：小市值因子权重（市值越小分数越高）
  
  # 选股参数（极度集中，追求高弹性）
  top_n: 3              # 仅选取3只股票，单只约33%仓位
  min_listing_days: 126  # 最小上市天数（约6个月）
  
  # 因子列名配置（与 features.py 产出列名一致）
  # small_cap_zscore: 小市值因子 = -log(流通市值) 的标准化
  # turnover_5d_zscore: 5日平均换手率的标准化
  # rsi_20_zscore: 20日RSI的标准化
  value_col: "small_cap_zscore"       # 借用 value 位置放市值因子
  quality_col: "turnover_5d_zscore"   # 借用 quality 位置放换手率因子
  momentum_col: "rsi_20_zscore"       # 保持动量因子
  size_col: "small_cap_zscore"        # 新增：独立市值因子列名
  
  # 调仓频率: monthly(月度), weekly(周度)
  # 周度调仓更适合激进策略，快速响应市场变化
  rebalance_frequency: "weekly"
  
  # 再平衡缓冲区：权重变化小于此阈值时不调整
  # 激进策略降低缓冲区（2%），更敏感响应信号变化
  rebalance_buffer: 0.02

# 投资组合配置 - 激进型（集中持仓）
portfolio:
  # 总资金（元）
  total_capital: 300000
  
  # 单只股票最大权重
  # 对于3只股票的激进策略，允许更高集中度
  max_weight: 0.40
  
  # 单只股票最小权重
  min_weight: 0.0
  
  # 无风险利率
  risk_free_rate: 0.02
  
  # 优化目标: max_sharpe(最大夏普比率), min_volatility(最小波动率), equal_weight(等权重)
  # 激进策略使用等权重，避免优化器在高波动股票上的不稳定
  optimization_objective: "equal_weight"
  
  # 协方差压缩方法: ledoit_wolf, oracle_approximating, exponential
  shrinkage_type: "ledoit_wolf"
  
  # 预期收益率计算方法: mean_historical, ema_historical
  returns_method: "mean_historical"
  
  # 协方差计算回溯天数
  lookback_days: 252

# 风险控制配置 - 激进型参数
risk:
  # 止损比例（收紧：做错即砍，快速止损）
  stop_loss: 0.05
  
  # 止盈比例
  take_profit: 0.20
  
  # 单日最大亏损比例
  max_daily_loss: 0.05
  
  # 最大回撤限制（放宽：容忍更高波动以获取高收益）
  max_drawdown: 0.25
  
  # 大盘风控参数（激进型：使用 MA60 + 20日跌幅判断）
  # 仅当大盘跌破60日均线且20日跌幅超过5%时才触发熔断
  market_risk:
    enabled: true
    ma_period: 60           # 使用60日均线（牛熊线）替代原20日均线
    drop_threshold: 0.05    # 20日跌幅阈值（5%）
    drop_lookback: 20       # 跌幅回溯天数

# 交易配置
trading:
  # 交易费用（双边）- 标准A股费率
  commission_rate: 0.0003
  
  # 印花税（卖出时）
  stamp_duty: 0.001
  
  # 滑点比例
  slippage: 0.001
  
  # 最小交易单位（股）
  min_trade_unit: 100

# 报告配置
report:
  # 报告格式: markdown, html
  format: "html"
  
  # 报告输出目录
  output_dir: "reports"
  
  # 是否发送邮件通知
  send_email: false
  
  # 邮件配置
  email:
    smtp_server: ""
    smtp_port: 587
    sender: ""
    password: ""
    recipients: []

# 消息推送配置
notification:
  # PushPlus 微信推送 (http://www.pushplus.plus/)
  # Token 获取方式：注册 PushPlus 账号后，在个人中心获取
  # 也可通过环境变量 PUSHPLUS_TOKEN 配置（优先级更高）
  pushplus_token: "c71a6a03122e41e3b0b691693748c0ce"
  
  # 是否启用推送
  enabled: true

# 日志配置
logging:
  # 日志级别: DEBUG, INFO, WARNING, ERROR
  level: "INFO"
  
  # 日志文件目录
  log_dir: "logs"
  
  # 日志文件保留天数
  retention_days: 30

# 回测配置
backtest:
  # 回测开始日期
  start_date: "2023-01-01"
  
  # 回测结束日期
  end_date: "2024-01-01"
  
  # 初始资金
  initial_capital: 300000
  
  # 基准指数
  # ZZ500 (000905) 更适合中小盘策略的股票池匹配度
  benchmark: "000905"  # 中证500
